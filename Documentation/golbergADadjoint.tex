
\documentclass{report}
\usepackage{graphicx}
\usepackage[tiny]{titlesec}
\usepackage{amsmath}
\usepackage{fixltx2e}
\usepackage{changepage}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in 

\setlength{\parindent}{0pt}

\begin{document}

\section*{General questions from "Parameter and state estimations with a time-dependent adjoint marine ice sheet model"}
1. Table 2 and Table 3 appear as identical. Is this on purpose?\\


\section*{Constructing a Forward Model/Adjoint Method Workflow}



\section*{Forward Model}
Begin With: \\
\hspace*{6ex}u\textsubscript{0}:			From observations \\
\hspace*{6ex}$\beta$:	Homogeneous, or calculated using Shallow Ice Approximation \\

These determine:\\
\hspace*{6ex}$\overline{\nu}^{0} = F_{v}(u^{0},\beta^{0})$	\\	
\hspace*{6ex}$\beta_{Eff}^{0} = F_{B}(u^{0},\overline{\nu}^{0},\beta^{0})$\\


Loop through Picard Iterations: 1,2,...,n 
\begin{adjustwidth}{2.5em}{0pt}
Construct: \quad $A_{n} = F_{A}(\beta_{Eff}^n,\overline{\nu}^{n})$\\
Solve: \quad\quad\quad $u^{n+1} = A_{n}^{-1} * \tau$\\
Update: \quad\quad $v^{n+1} = F_{v}(u^{n+1},\overline{\nu}^{n},\beta^{n})$\\
\hspace*{13ex}  $B_{Eff}^{n+1} = F_{B_{Eff}}(\overline{\nu}^{n+1},\beta^{n})$\\
Check Convergence
\end{adjustwidth}
End
\section*{Adjoint Model}

Adjoint of Cost Function
$\delta^{*} u^{n+1} = (\frac{ \partial F_{J}}{\partial u})^{T}$\\

Loop through Picard Iterations in Reverse: n,n-1,...,1
\begin{adjustwidth}{2.5em}{0pt}

Reverse\_Update:\\
\hspace*{21.5ex}  [Pass on initial iteration since $\delta^{*} u^{n+1}$ comes from the adjoint of the cost function]\\
\hspace*{21.5ex}  $\delta^{*} u^{n+1} = (\frac{\partial F_{\overline{\nu}}}{\partial u})^{T} \delta^{*}\overline{\nu}^{n+1} $\\
\hspace*{21.5ex}  $\delta^{*} \beta^{n} =  (\frac{\partial F_{\beta}}{\partial \beta^{n}})^{T} \delta^{*}\beta_{Eff}^{n+1} $\\


Reverse\_Solve: \quad\quad\quad $A_{n}^{T} b = \delta^{*} u^{n+1}$ [For b]\\
\hspace*{21.5ex} $\delta^{*}A = -b (u^{n+1})^{T}$\\

Reverse\_Construct: \quad $\delta^{*} \beta_{Eff} = (\frac {\partial F_{A}}{\partial \beta_{Eff}})^{T} \delta^{*} A$\\
\hspace*{21.5ex} $ \delta^{*} \overline{\nu} = (\frac {\partial F_{A}}{\partial \overline{\nu}})^{T} \delta^{*} A$

\end{adjustwidth}
End\\

Pass $\delta^{*} \beta_{Eff}$ to Optimization Algorithm \\

\section*{Important Functions}
Cost Function:\\
$J = F_{J}(u) =  \int \int \frac{1}{2}(u_{obs} - u_{s})^{2} dxdy$ \quad\quad where $u_{s} = \frac{u(1+\beta F_{1})}{1 + \beta F_{2}}$\\\\


Integrated Viscosity:\\  
$\overline{\nu} = F_{\overline{\nu}}(u,\overline{\nu} \; [optionally] ,\beta) =  \frac{1}{h} \int \frac{1}{2} \beta(  (\partial_x \overline{u})^{2} + (\partial_y \overline{v})^{2} + 
							(\partial_x \overline{u})(\partial_y \overline{v}) +
							\frac{1}{4} (\partial_y \overline{u} + \partial_x \overline{v} )^{\frac{1}{2}} +
							\frac{1}{4} (\partial_z u )^{2} + \frac{1}{4} (\partial_z v )^{2} + \epsilon^{2}    )^{\frac{1-n}{2n}}$ dz \\\\
where:
$\partial_z u = \frac{\sigma_{xz}}{\overline{\nu}}	 = \frac{\tau_{bx} (s-z)}{\overline{\nu}h} = \frac{{\beta_{Eff}\overline{u}} (s-z)}{\overline{\nu}h}$ and similarly for $\partial_z v$\\	
							
Effective Basal Slipperiness:\\  
$\beta_{Eff} = F_{B_{Eff}}(\beta,\overline{\nu}) = \frac{\beta}{1 + \beta F_{2}}$ \quad\quad\quad\quad\quad\quad\quad where $F_{2} = \int_{b}^{s}\frac{1}{\overline{\nu}} (\frac{s -z}{h})^{2} dz$\\\\

Basal Slipperiness: \\ 
$\beta = F_{B}(\beta_{Eff},\overline{\nu}) = \frac{\beta_{Eff}}{1 - \beta_{Eff} F_{2}}$ 

\section*{Automatic Differentiation}
Required on the following: $F_{J}, F_{\overline{\nu}}, F_{A}, F_{B}, F_{B_Eff}$



\end{document}